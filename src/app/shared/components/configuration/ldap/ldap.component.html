<section class="mg-0" style="align-items: stretch">
    @if (isAdmin) {
      <div class="adress column-49">
        <div class="title-syslog">
          <h2 class="title-section title-tooltip">Configuration LDAP <mat-icon matTooltip="Categorizes rules or alerts into predefined types, helping in organizing, prioritizing, and responding to different security or system events.">help_outline</mat-icon></h2>
        </div>
        <mat-card class="radm-card">
          <div class="d-flex" style="padding: 2% 2% 3% 3%">
            <h3 class="card-title">
            </h3>
            <div class="buttons">
               @if(!configurationLdap() || configurationLdap().length === 0) {
               <button
                mat-raised-button
                class="cta-btn cta btn-color"
                matTooltip="Add LDAP Configuration"
                (click)="openDialog(configurationLdap(), 'Add LDAP', 'add_ldap', 'LDAP')"
              >
                <mat-icon class="btn-icon">add</mat-icon>
              </button>
            }
            @else {
              <button
                mat-raised-button
                class="cta-btn cta btn-color"
                [matTooltip]="configurationLdap().enabled ? 'Disable LDAP': 'Enable LDAP'"
              >
                  <mat-slide-toggle
                    [checked]="configurationLdap().enabled"
                    (change)="toggleLdap($event)"
                  >
                  </mat-slide-toggle>
              </button>
              <button
                mat-raised-button
                (click)="openDialog(configurationLdap(), 'Update LDAP', 'update_ldap', 'LDAP')"
                class="btn btn-color"
                matTooltip="Update LDAP Configuration"
              >
                <mat-icon class="btn-icon">edit</mat-icon>
              </button>
              <button
                mat-raised-button
                (click)="openDialog('', 'Delete Ldap Configuration', 'delete_ldap', '')"
                class="btn btn-color"
                matTooltip="Delete LDAP Configuration">
              <mat-icon class="btn-icon">delete</mat-icon>
              </button>
              <!-- @if(configurationLdap().enabled) {
                <button
                  mat-raised-button
                  (click)="testConnectivity()"
                  class="btn btn-color"
                  matTooltip="Test Connectivity to LDAP Server"
                >
                  <mat-icon class="btn-icon">wifi</mat-icon>
                </button>
              } -->
            }
            </div>
          </div>
          <mat-card-content>
            @if(!configurationLdap() || configurationLdap().length === 0) {
              <p class="no-data">No Ldap Configuration found</p>
            }
            @else {
              <table mat-table [dataSource]="extractLDAPData(configurationLdap())" class="file-table">


                <ng-container matColumnDef="key">
                  <td mat-cell *matCellDef="let item" class="file-name-cell label">{{ item.key|uppercase }}</td>
                </ng-container>

                <ng-container matColumnDef="value">
                  <td mat-cell *matCellDef="let item" class="file-name-cell">
                    {{ item.value == true || item.value == false ? (item.value ? 'Enabled' : 'Disabled') : item.value }}</td>
                </ng-container>
                <tr mat-row *matRowDef="let row; columns: ['key', 'value']"></tr>
              </table>
            }
          </mat-card-content>
        </mat-card>
      </div>
    }
</section>
