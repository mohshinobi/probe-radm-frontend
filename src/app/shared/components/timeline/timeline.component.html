<div class="radm-card">
  <div class="card-titl">
    <h1>Attack TimeLine</h1>
  </div>
  <div class="card">
    @if(lastData?.alert)
    {
    <p class="p">
      {{ lastData.alert.signature }}, Severity: {{ lastData.alert.severity }}
    </p>
    }

  </div>
  <div class="timeline">
  @for(event of events; track $index) {
    {{getCombinedEvents|json}}
    <div class="event-header">
      <div class="column-10 event-icon">
        <mat-icon [style.color]="getColor(event?.alert?.severity).iconColor" class="event-icon">
          {{ getIcon($index) }}
        </mat-icon>
      </div>

      <div class="column-10 event-info">
        <p class="event-date">
          {{ event.timestamp | date: "yyyy-MM-dd HH:mm:ss" : 'UTC' }}
        </p>
      </div>

      <div class="column-10 event-info">
        <p class="event-src-dst">
          src {{ event?.src_ip }} <br>
          dst {{ event?.dest_ip }}
        </p>
      </div>

      <div class="column-50 event-body">
        <div class="event-description" [ngStyle]="{'color': getColor(event.alert.severity).textColor, 'background-color': getColor(event.alert.severity).backgroundColor}">
          {{event?.alert?.signature }}
        </div>
        @if ((events.length - 1) > $index) {
          <div class="arrow-container">
            <mat-icon>arrow_downward</mat-icon>
          </div>
        }
      </div>
    </div>
  }
</div>

</div>
